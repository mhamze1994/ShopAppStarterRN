var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");var _interopRequireWildcard=require("@babel/runtime/helpers/interopRequireWildcard");Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _defineProperty2=_interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));var _classCallCheck2=_interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));var _createClass2=_interopRequireDefault(require("@babel/runtime/helpers/createClass"));var _inherits2=_interopRequireDefault(require("@babel/runtime/helpers/inherits"));var _possibleConstructorReturn2=_interopRequireDefault(require("@babel/runtime/helpers/possibleConstructorReturn"));var _getPrototypeOf2=_interopRequireDefault(require("@babel/runtime/helpers/getPrototypeOf"));var _react=_interopRequireWildcard(require("react"));var _reactNative=require("react-native");var _reactNativeUnorderedList=_interopRequireDefault(require("react-native-unordered-list"));var Theme=_interopRequireWildcard(require("./theme/Theme"));var RepoProduct=_interopRequireWildcard(require("./repository/RepoSample"));var RepoCart=_interopRequireWildcard(require("./repository/RepoCart"));var _ScreenHome=require("./ScreenHome");var _reactNativeReanimated=_interopRequireDefault(require("react-native-reanimated"));var _reanimatedBottomSheet=_interopRequireDefault(require("reanimated-bottom-sheet"));var _InputCounter=_interopRequireDefault(require("./widget/InputCounter"));var _ActionButton=_interopRequireDefault(require("./widget/ActionButton"));var _reactNativeSimpleToast=_interopRequireDefault(require("react-native-simple-toast"));var _jsxFileName="E:\\Project\\ReactNative\\ShoppingApp\\src\\ScreenProductDetails.js",_this3=this;function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;});keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach(function(key){(0,_defineProperty2.default)(target,key,source[key]);});}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source));}else{ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}}return target;}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=(0,_getPrototypeOf2.default)(Derived),result;if(hasNativeReflectConstruct){var NewTarget=(0,_getPrototypeOf2.default)(this).constructor;result=Reflect.construct(Super,arguments,NewTarget);}else{result=Super.apply(this,arguments);}return(0,_possibleConstructorReturn2.default)(this,result);};}function _isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));return true;}catch(e){return false;}}var ScreenProductDetails=function(_React$Component){(0,_inherits2.default)(ScreenProductDetails,_React$Component);var _super=_createSuper(ScreenProductDetails);function ScreenProductDetails(props){var _this;(0,_classCallCheck2.default)(this,ScreenProductDetails);_this=_super.call(this,props);_this.state={product:RepoProduct.getProduct(_this.props.route.params.selectedItem.id),isAdded:RepoCart.isAdded(_this.props.route.params.selectedItem.id)};return _this;}(0,_createClass2.default)(ScreenProductDetails,[{key:"render",value:function render(){return this.displayProduct();}},{key:"displayProduct",value:function displayProduct(){var _this2=this;if(!this.state.product){return _react.default.createElement(_reactNative.View,{style:{flex:1},__self:this,__source:{fileName:_jsxFileName,lineNumber:35,columnNumber:17}},_react.default.createElement(_reactNative.Text,{style:{fontSize:18,flex:1,textAlignVertical:'center',textAlign:'center',fontFamily:'yekan'},__self:this,__source:{fileName:_jsxFileName,lineNumber:36,columnNumber:21}},"\u06A9\u0627\u0644\u0627\u06CC \u0645\u0648\u0631\u062F \u0646\u0638\u0631 \u062F\u0631\u06CC\u0627\u0641\u062A \u0646\u0634\u062F!"));}else{var fall=new _reactNativeReanimated.default.Value(1);var sheetRef=_react.default.createRef(null);return _react.default.createElement(_reactNative.View,{style:{backgroundColor:'#ffffff',flex:1},__self:this,__source:{fileName:_jsxFileName,lineNumber:43,columnNumber:17}},_react.default.createElement(_reactNative.ScrollView,{style:{flex:1},__self:this,__source:{fileName:_jsxFileName,lineNumber:44,columnNumber:21}},_react.default.createElement(_reactNative.Image,{resizeMode:"center",style:{marginTop:20,marginBottom:20,width:'100%',height:_reactNative.Dimensions.get("window").height*0.3},source:this.state.product.photo,__self:this,__source:{fileName:_jsxFileName,lineNumber:45,columnNumber:25}}),_react.default.createElement(_reactNative.Text,{style:{fontSize:21,fontFamily:'yekan_bold',padding:15,writingDirection:'rtl'},__self:this,__source:{fileName:_jsxFileName,lineNumber:46,columnNumber:25}},this.state.product.title),_react.default.createElement(_reactNative.View,{style:{flexDirection:'row',justifyContent:'space-between'},__self:this,__source:{fileName:_jsxFileName,lineNumber:47,columnNumber:25}},_react.default.createElement(_reactNative.Text,{style:{fontFamily:'yekan_bold',fontSize:24,color:Theme.colorAscend,margin:10,padding:10},__self:this,__source:{fileName:_jsxFileName,lineNumber:48,columnNumber:29}},"\u0642\u06CC\u0645\u062A : ",this.state.product.price," \u062A\u0648\u0645\u0627\u0646"),_react.default.createElement(_reactNative.Text,{style:{fontFamily:'yekan',textAlignVertical:'center',margin:10,padding:15,color:"#ffffff",backgroundColor:Theme.colorAscend,borderRadius:25},__self:this,__source:{fileName:_jsxFileName,lineNumber:49,columnNumber:29}},"\u062A\u062E\u0641\u06CC\u0641 :\u200C ",this.state.product.discount,"\u066A")),_react.default.createElement(_reactNative.View,{style:{padding:10},__self:this,__source:{fileName:_jsxFileName,lineNumber:51,columnNumber:25}},_react.default.createElement(_reactNativeUnorderedList.default,{bulletUnicode:0x00a0,__self:this,__source:{fileName:_jsxFileName,lineNumber:52,columnNumber:29}},_react.default.createElement(_reactNative.Text,{style:{fontFamily:'yekan'},__self:this,__source:{fileName:_jsxFileName,lineNumber:52,columnNumber:68}},"\u0648\u06CC\u0698\u06AF\u06CC \u0647\u0627"),_react.default.createElement(_reactNativeUnorderedList.default,{bulletUnicode:0x00a0,__self:this,__source:{fileName:_jsxFileName,lineNumber:53,columnNumber:33}},_react.default.createElement(_reactNativeUnorderedList.default,{bulletUnicode:0x25AA,color:Theme.colorPrimary,style:{fontSize:Theme.dimenIconFontSize},__self:this,__source:{fileName:_jsxFileName,lineNumber:54,columnNumber:37}},_react.default.createElement(_reactNative.Text,{style:{fontFamily:'yekan'},__self:this,__source:{fileName:_jsxFileName,lineNumber:54,columnNumber:149}},"\u067E\u0627\u0631\u0686\u0647 \u0645\u0634 ")),_react.default.createElement(_reactNativeUnorderedList.default,{bulletUnicode:0x25AA,color:Theme.colorPrimary,style:{fontSize:Theme.dimenIconFontSize},__self:this,__source:{fileName:_jsxFileName,lineNumber:55,columnNumber:37}},_react.default.createElement(_reactNative.Text,{style:{fontFamily:'yekan'},__self:this,__source:{fileName:_jsxFileName,lineNumber:55,columnNumber:149}},"\u06A9\u0627\u0647\u0634 \u0641\u0634\u0627\u0631 ")),_react.default.createElement(_reactNativeUnorderedList.default,{bulletUnicode:0x25AA,color:Theme.colorPrimary,style:{fontSize:Theme.dimenIconFontSize},__self:this,__source:{fileName:_jsxFileName,lineNumber:56,columnNumber:37}},_react.default.createElement(_reactNative.Text,{style:{fontFamily:'yekan'},__self:this,__source:{fileName:_jsxFileName,lineNumber:56,columnNumber:148}},"\u0628\u0646\u062F\u06CC")))),_react.default.createElement(_reactNative.Text,{__self:this,__source:{fileName:_jsxFileName,lineNumber:59,columnNumber:29}}," "),_react.default.createElement(_reactNativeUnorderedList.default,{bulletUnicode:0x00a0,__self:this,__source:{fileName:_jsxFileName,lineNumber:60,columnNumber:29}},_react.default.createElement(_reactNative.Text,{style:{fontFamily:'yekan'},__self:this,__source:{fileName:_jsxFileName,lineNumber:60,columnNumber:68}},"\u0633\u0627\u06CC\u0632 \u0647\u0627"),_react.default.createElement(_reactNative.View,{style:{flexDirection:'row',justifyContent:'space-around'},__self:this,__source:{fileName:_jsxFileName,lineNumber:61,columnNumber:33}},_react.default.createElement(_reactNative.Text,{style:{color:Theme.colorAscend,padding:10,borderRadius:20,borderWidth:1,borderColor:Theme.colorAscend,flex:1,margin:10,textAlign:'center'},__self:this,__source:{fileName:_jsxFileName,lineNumber:62,columnNumber:37}},"37"),_react.default.createElement(_reactNative.Text,{style:{color:Theme.colorAscend,padding:10,borderRadius:20,borderWidth:1,borderColor:Theme.colorAscend,flex:1,margin:10,textAlign:'center'},__self:this,__source:{fileName:_jsxFileName,lineNumber:63,columnNumber:37}},"40"),_react.default.createElement(_reactNative.Text,{style:{color:Theme.colorAscend,padding:10,borderRadius:20,borderWidth:1,borderColor:Theme.colorAscend,flex:1,margin:10,textAlign:'center'},__self:this,__source:{fileName:_jsxFileName,lineNumber:64,columnNumber:37}},"41"),_react.default.createElement(_reactNative.Text,{style:{color:Theme.colorAscend,padding:10,borderRadius:20,borderWidth:1,borderColor:Theme.colorAscend,flex:1,margin:10,textAlign:'center'},__self:this,__source:{fileName:_jsxFileName,lineNumber:65,columnNumber:37}},"42")))),_react.default.createElement(_reactNative.Text,{style:{padding:10,fontFamily:'yekan'},__self:this,__source:{fileName:_jsxFileName,lineNumber:70,columnNumber:25}},"\u0645\u062D\u0635\u0648\u0644\u0627\u062A \u0645\u0634\u0627\u0628\u0647"),_react.default.createElement(_reactNative.ScrollView,{horizontal:true,__self:this,__source:{fileName:_jsxFileName,lineNumber:71,columnNumber:25}},_react.default.createElement(_ScreenHome.HomeItemProductLarge,{nav:this.props.navigation,__self:this,__source:{fileName:_jsxFileName,lineNumber:72,columnNumber:29}}),_react.default.createElement(_ScreenHome.HomeItemProductLarge,{nav:this.props.navigation,__self:this,__source:{fileName:_jsxFileName,lineNumber:73,columnNumber:29}}),_react.default.createElement(_ScreenHome.HomeItemProductLarge,{nav:this.props.navigation,__self:this,__source:{fileName:_jsxFileName,lineNumber:74,columnNumber:29}}))),_react.default.createElement(_reactNative.Pressable,{onPress:function onPress(){return _this2.onAddBtnPressed(sheetRef);},android_ripple:{color:Theme.colorShadow},__self:this,__source:{fileName:_jsxFileName,lineNumber:79,columnNumber:21}},this.renderButton()),_react.default.createElement(_reanimatedBottomSheet.default,{ref:sheetRef,callbackNode:fall,initialSnap:1,snapPoints:['60%',0],borderRadius:35,renderContent:function renderContent(){return _react.default.createElement(BottomSheetPurchase,{parent:_this2,sheetRef:sheetRef,product:_this2.state.product,__self:_this2,__source:{fileName:_jsxFileName,lineNumber:89,columnNumber:52}});},__self:this,__source:{fileName:_jsxFileName,lineNumber:83,columnNumber:21}}),renderShadow(fall));}}},{key:"onAddBtnPressed",value:function onAddBtnPressed(sheetRef){if(this.state.isAdded){RepoCart.remove(this.state.product.id);showMessage('از سبد حذف شد.');this.setState({isAdded:RepoCart.isAdded(this.state.product.id)});}else{sheetRef.current.snapTo(0);}}},{key:"renderButton",value:function renderButton(){if(this.state.isAdded){return _react.default.createElement(_reactNative.Text,{style:{margin:10,borderRadius:10,textAlign:"center",height:55,fontSize:18,backgroundColor:Theme.colorDanger,color:Theme.colorWhite,fontFamily:Theme.fontRegular,textAlignVertical:'center'},__self:this,__source:{fileName:_jsxFileName,lineNumber:111,columnNumber:20}},"\u062D\u0630\u0641 \u0627\u0632 \u0633\u0628\u062F");}else{return _react.default.createElement(_reactNative.Text,{style:{margin:10,borderRadius:10,textAlign:"center",height:55,fontSize:18,backgroundColor:Theme.colorPrimary,color:Theme.colorWhite,fontFamily:Theme.fontRegular,textAlignVertical:'center'},__self:this,__source:{fileName:_jsxFileName,lineNumber:113,columnNumber:20}},"\u0627\u0641\u0632\u0648\u062F\u0646 \u0628\u0647 \u0633\u0628\u062F \u062E\u0631\u06CC\u062F");}}}]);return ScreenProductDetails;}(_react.default.Component);exports.default=ScreenProductDetails;var renderShadow=function renderShadow(fall){var animatedShadowOpacity=_reactNativeReanimated.default.interpolate(fall,{inputRange:[0,1],outputRange:[0.5,0]});var AnimatedView=_reactNativeReanimated.default.View;return _react.default.createElement(AnimatedView,{pointerEvents:"none",style:[styles.shadowContainer,{opacity:animatedShadowOpacity}],__self:_this3,__source:{fileName:_jsxFileName,lineNumber:125,columnNumber:7}});};var BottomSheetPurchase=function(_React$Component2){(0,_inherits2.default)(BottomSheetPurchase,_React$Component2);var _super2=_createSuper(BottomSheetPurchase);function BottomSheetPurchase(props){var _this4;(0,_classCallCheck2.default)(this,BottomSheetPurchase);_this4=_super2.call(this,props);_this4.state={count:1};return _this4;}(0,_createClass2.default)(BottomSheetPurchase,[{key:"render",value:function render(){var _this5=this;return _react.default.createElement(_reactNative.View,{style:styles.bottomSheet,__self:this,__source:{fileName:_jsxFileName,lineNumber:148,columnNumber:13}},_react.default.createElement(_reactNative.Text,{numberOfLines:3,style:styles.bottomSheetHeaderLabel,__self:this,__source:{fileName:_jsxFileName,lineNumber:149,columnNumber:17}},this.props.product.title),_react.default.createElement(_reactNative.View,{style:styles.bottomSheetHeader,__self:this,__source:{fileName:_jsxFileName,lineNumber:150,columnNumber:17}},_react.default.createElement(_InputCounter.default,{callback:function callback(currentCount){_this5.updateCount(currentCount);},layout:'vertical',__self:this,__source:{fileName:_jsxFileName,lineNumber:151,columnNumber:21}}),_react.default.createElement(_reactNative.Image,{style:styles.bottomSheetImage,source:this.props.product.photo,__self:this,__source:{fileName:_jsxFileName,lineNumber:152,columnNumber:21}})),_react.default.createElement(_reactNative.Text,{style:styles.bottomSheetPrice,__self:this,__source:{fileName:_jsxFileName,lineNumber:154,columnNumber:17}},"مبلغ کل :"+this.state.count*this.props.product.price),_react.default.createElement(_ActionButton.default,{onPress:function onPress(){_this5.insertIntoCart(_this5.props.product.id,_this5.state.count);},style:styles.bottomSheetConfirmBtn,label:"افزودن",__self:this,__source:{fileName:_jsxFileName,lineNumber:155,columnNumber:17}}));}},{key:"renderButton",value:function renderButton(){if(this.state.isAdded){return _react.default.createElement(_reactNative.Text,{style:styles.bottomSheetPrice,__self:this,__source:{fileName:_jsxFileName,lineNumber:162,columnNumber:20}},"مبلغ کل :"+this.state.count*this.props.product.price);}else{return _react.default.createElement(_reactNative.Text,{style:styles.bottomSheetPrice,__self:this,__source:{fileName:_jsxFileName,lineNumber:164,columnNumber:20}},"\u062D\u0630\u0641 \u0627\u0632 \u0633\u0628\u062F");}}},{key:"insertIntoCart",value:function insertIntoCart(productId,count){RepoCart.put(productId,count);showMessage('به سبد افزوده شد');this.props.parent.setState({isAdded:RepoCart.isAdded(productId)});this.props.sheetRef.current.snapTo(1);}},{key:"updateCount",value:function updateCount(currentCount){this.setState({count:currentCount});}}]);return BottomSheetPurchase;}(_react.default.Component);function showMessage(msg){_reactNativeSimpleToast.default.show(msg,_reactNativeSimpleToast.default.SHORT,['UIAlertController']);}var styles=_reactNative.StyleSheet.create({bottomSheetConfirmBtn:{width:'100%'},bottomSheetPrice:{fontFamily:'yekan_bold',padding:20,color:Theme.colorAscend,fontSize:26,textAlign:'left',width:'100%',textAlignVertical:'center'},bottomSheet:{backgroundColor:'#ffffff',padding:16,height:'100%',alignItems:'center'},bottomSheetHeaderLabel:{fontFamily:'yekan_bold',width:'100%',fontSize:18,paddingRight:15,paddingLeft:15,paddingTop:10,paddingBottom:10,marginTop:10,borderBottomWidth:1,borderColor:Theme.colorPrimary,textAlignVertical:'bottom'},bottomSheetImage:{margin:15,height:_reactNative.Dimensions.get("window").width*0.5,width:_reactNative.Dimensions.get("window").width*0.5,resizeMode:'center'},bottomSheetHeader:{alignItems:'stretch',width:'100%',flexDirection:'row',justifyContent:'space-between'},shadowContainer:_objectSpread(_objectSpread({},_reactNative.StyleSheet.absoluteFillObject),{},{backgroundColor:'#000'})});